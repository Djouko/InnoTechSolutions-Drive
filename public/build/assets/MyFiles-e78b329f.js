import{J as S,v as B,j as _,o as i,f as m,b as e,d as v,a as r,F as C,c as V,w,u as d,n as M,k as H,l as T,i as K,m as R,p as G,q as E,g as F,O,h as L,t as y,e as J}from"./app-4475db5a.js";import{s as j,a as A,e as Q,O as W,A as X,H as Y}from"./AuthenticatedLayout-c661fba2.js";import{h as Z,_ as ee,a as te}from"./http-helper-398e53a1.js";import{_ as I}from"./Checkbox-e2a574cc.js";import{_ as le}from"./ConfirmationDialog-ce2e7eb5.js";import{_ as se}from"./DownloadFilesButton-ee13082d.js";import{_ as ae,a as oe}from"./SecondaryButton-45ba7a27.js";import{_ as ne,a as re,b as ie}from"./TextInput-5f928024.js";import{P as de}from"./PrimaryButton-0f143ca0.js";import"./ApplicationLogo-84b1a804.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./DangerButton-c36c1890.js";const ce=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1),ue={__name:"DeleteFilesButton",props:{deleteAll:{type:Boolean,required:!1,default:!1},deleteIds:{type:Array,required:!1}},emits:["delete"],setup(p,{emit:x}){const l=p,s=S(),o=B({all:null,ids:[],parent_id:null}),u=_(!1);function f(){if(!l.deleteAll&&!l.deleteIds.length){j("Please select at least one file to delete");return}u.value=!0}function n(){u.value=!1}function h(){o.parent_id=s.props.folder.id,l.deleteAll?o.all=!0:o.ids=l.deleteIds,o.delete(route("file.delete"),{onSuccess:()=>{u.value=!1,x("delete"),A("Selected files have been deleted")}}),console.log("Delete",l.deleteAll,l.deleteIds)}return(g,k)=>(i(),m(C,null,[e("button",{onClick:f,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white"},[ce,v(" Delete ")]),r(le,{show:u.value,message:"Are you sure you want to delete selected files?",onCancel:n,onConfirm:h},null,8,["show"])],64))}},me={class:"p-6"},fe=e("h2",{class:"text-lg font-medium text-gray-900"}," Share Files ",-1),he={class:"mt-6"},pe={class:"mt-6 flex justify-end"},xe={__name:"ShareFilesModal",props:{modelValue:Boolean,allSelected:Boolean,selectedIds:Array},emits:["update:modelValue"],setup(p,{emit:x}){const l=p,s=B({email:null,all:!1,ids:[],parent_id:null}),o=S(),u=_(null);function f(){T(()=>u.value.focus())}function n(){s.parent_id=o.props.folder.id,console.log(l.selectedIds,l.allSelected),l.allSelected?(s.all=!0,s.ids=[]):s.ids=l.selectedIds;const g=s.email;s.post(route("file.share"),{preserveScroll:!0,onSuccess:()=>{h(),s.reset(),A(`Selected files will be shared to "${g}" if the emails exists in the system`)},onError:()=>u.value.focus()})}function h(){x("update:modelValue"),s.clearErrors(),s.reset()}return(g,k)=>(i(),V(oe,{show:l.modelValue,onShow:f,"max-width":"sm"},{default:w(()=>[e("div",me,[fe,e("div",he,[r(ne,{for:"shareEmail",value:"Enter Email Address",class:"sr-only"}),r(re,{type:"text",ref_key:"emailInput",ref:u,id:"shareEmail",modelValue:d(s).email,"onUpdate:modelValue":k[0]||(k[0]=$=>d(s).email=$),class:M([d(s).errors.email?"border-red-500 focus:border-red-500 focus:ring-red-500":"","mt-1 block w-full"]),placeholder:"Enter Email Address",onKeyup:H(n,["enter"])},null,8,["modelValue","class","onKeyup"]),r(ie,{message:d(s).errors.email,class:"mt-2"},null,8,["message"])]),e("div",pe,[r(ae,{onClick:h},{default:w(()=>[v("Cancel")]),_:1}),r(de,{class:M(["ml-3",{"opacity-25":d(s).processing}]),onClick:n,disable:d(s).processing},{default:w(()=>[v(" Submit ")]),_:1},8,["class","disable"])])])]),_:1},8,["show"]))}},_e=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{"fill-rule":"evenodd",d:"M15.75 4.5a3 3 0 11.825 2.066l-8.421 4.679a3.002 3.002 0 010 1.51l8.421 4.679a3 3 0 11-.729 1.31l-8.421-4.678a3 3 0 110-4.132l8.421-4.679a3 3 0 01-.096-.755z","clip-rule":"evenodd"})],-1),ve={__name:"ShareFilesButton",props:{allSelected:{type:Boolean,required:!1,default:!1},selectedIds:{type:Array,required:!1}},emits:["restore"],setup(p,{emit:x}){const l=p;S(),B({all:null,ids:[],parent_id:null});const s=_(!1);function o(){if(!l.allSelected&&!l.selectedIds.length){j("Please select at least one file to share");return}s.value=!0}return(u,f)=>(i(),m(C,null,[e("button",{onClick:o,class:"inline-flex items-center px-4 py-2 text-sm font-medium text-gray-900 bg-white border border-gray-200 rounded-lg hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-2 focus:ring-blue-700 focus:text-blue-700 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-blue-500 dark:focus:text-white mr-3"},[_e,v(" Share ")]),r(xe,{modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=n=>s.value=n),"all-selected":p.allSelected,"selected-ids":p.selectedIds},null,8,["modelValue","all-selected","selected-ids"])],64))}},ge={class:"flex items-center justify-between p-1 mb-3"},ye={class:"inline-flex items-center space-x-1 md:space-x-3"},we={key:1,class:"flex items-center"},ke=e("svg",{"aria-hidden":"true",class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),be={class:"flex"},Ce={class:"flex items-center mr-3"},Se={class:"flex-1 overflow-auto"},$e={class:"min-w-full"},Fe={class:"bg-gray-100 border-b"},Ie={class:"text-sm font-medium text-gray-900 px-6 py-4 text-left w-[30px] max-w-[30px] pr-0"},Ve=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},null,-1),Me=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Name ",-1),Be={key:0,class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"},Ae=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Owner ",-1),De=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Last Modified ",-1),Ee=e("th",{class:"text-sm font-medium text-gray-900 px-6 py-4 text-left"}," Size ",-1),Oe=["onClick","onDblclick"],Le={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 w-[30px] max-w-[30px] pr-0"},je={class:"px-6 py-4 max-w-[40px] text-sm font-medium text-gray-900 text-yellow-500"},ze=["onClick"],Ue={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},Ne=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.563.563 0 01.321-.988l5.518-.442a.563.563 0 00.475-.345L11.48 3.5z"},null,-1),Pe=[Ne],qe={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-6 h-6"},He=e("path",{"fill-rule":"evenodd",d:"M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z","clip-rule":"evenodd"},null,-1),Te=[He],Ke={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 flex items-center"},Re={key:0,class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Ge={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Je={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Qe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},We={key:0,class:"py-8 text-center text-sm text-gray-400"},dt={__name:"MyFiles",props:{files:Object,folder:Object,ancestors:Object},setup(p){const x=p;S();const l=_(!1),s=_(!1),o=_({}),u=_(null);let f=_("");const n=_({data:x.files.data,next:x.files.links.next});let h=null;const g=K(()=>Object.entries(o.value).filter(a=>a[1]).map(a=>a[0]));function k(a){a.is_folder&&O.visit(route("myFiles",{folder:a.path}))}function $(){console.log("load more"),console.log(n.value.next),n.value.next!==null&&Z(n.value.next).then(a=>{n.value.data=[...n.value.data,...a.data],n.value.next=a.links.next})}function z(){n.value.data.forEach(a=>{o.value[a.id]=l.value})}function U(a){o.value[a.id]=!o.value[a.id],D(a)}function D(a){if(!o.value[a.id])l.value=!1;else{let c=!0;for(let t of n.value.data)if(!o.value[t.id]){c=!1;break}l.value=c}}function N(){l.value=!1,o.value={}}function P(a){te(route("file.addToFavourites"),{id:a.id}).then(()=>{a.is_favourite=!a.is_favourite,A("Selected files have been added to favourites")}).catch(async c=>{console.log(c.error.message)})}function q(){s.value?h.set("favourites",1):h.delete("favourites"),O.get(window.location.pathname+"?"+h.toString())}return R(()=>{n.value={data:x.files.data,next:x.files.links.next}}),G(()=>{h=new URLSearchParams(window.location.search),s.value=h.get("favourites")==="1",f.value=h.get("search"),Q.on(W,c=>{f.value=c}),new IntersectionObserver(c=>c.forEach(t=>t.isIntersecting&&$()),{rootMargin:"-250px 0px 0px 0px"}).observe(u.value)}),(a,c)=>(i(),V(X,null,{default:w(()=>[e("nav",ge,[e("ol",ye,[(i(!0),m(C,null,E(p.ancestors.data,t=>(i(),m("li",{key:t.id,class:"inline-flex items-center"},[t.parent_id?(i(),m("div",we,[ke,r(d(L),{href:a.route("myFiles",{folder:t.path}),class:"ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2 dark:text-gray-400 dark:hover:text-white"},{default:w(()=>[v(y(t.name),1)]),_:2},1032,["href"])])):(i(),V(d(L),{key:0,href:a.route("myFiles"),class:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"},{default:w(()=>[r(d(Y),{class:"w-4 h-4"}),v(" My Files ")]),_:1},8,["href"]))]))),128))]),e("div",be,[e("label",Ce,[v(" Only Favourites "),r(I,{onChange:q,checked:s.value,"onUpdate:checked":c[0]||(c[0]=t=>s.value=t),class:"ml-2"},null,8,["checked"])]),r(ve,{"all-selected":l.value,"selected-ids":d(g)},null,8,["all-selected","selected-ids"]),r(se,{all:l.value,ids:d(g),class:"mr-2"},null,8,["all","ids"]),r(ue,{"delete-all":l.value,"delete-ids":d(g),onDelete:N},null,8,["delete-all","delete-ids"])])]),e("div",Se,[e("table",$e,[e("thead",Fe,[e("tr",null,[e("th",Ie,[r(I,{onChange:z,checked:l.value,"onUpdate:checked":c[1]||(c[1]=t=>l.value=t)},null,8,["checked"])]),Ve,Me,d(f)?(i(),m("th",Be," Path ")):F("",!0),Ae,De,Ee])]),e("tbody",null,[(i(!0),m(C,null,E(n.value.data,t=>(i(),m("tr",{key:t.id,onClick:b=>U(t),onDblclick:b=>k(t),class:M(["border-b transition duration-300 ease-in-out hover:bg-blue-100 cursor-pointer",o.value[t.id]||l.value?"bg-blue-50":"bg-white"])},[e("td",Le,[r(I,{onChange:b=>D(t),modelValue:o.value[t.id],"onUpdate:modelValue":b=>o.value[t.id]=b,checked:o.value[t.id]||l.value},null,8,["onChange","modelValue","onUpdate:modelValue","checked"])]),e("td",je,[e("div",{onClick:J(b=>P(t),["stop","prevent"])},[t.is_favourite?(i(),m("svg",qe,Te)):(i(),m("svg",Ue,Pe))],8,ze)]),e("td",Ke,[r(ee,{file:t},null,8,["file"]),v(" "+y(t.name),1)]),d(f)?(i(),m("td",Re,y(t.path),1)):F("",!0),e("td",Ge,y(t.owner),1),e("td",Je,y(t.updated_at),1),e("td",Qe,y(t.size),1)],42,Oe))),128))])]),n.value.data.length?F("",!0):(i(),m("div",We," There is no data in this folder ")),e("div",{ref_key:"loadMoreIntersect",ref:u},null,512)])]),_:1}))}};export{dt as default};
